# PBS 120 of X ‚Äî Ignoring Files in Git

Before we finish up with Git there's one important feature we accidentally skipped over ‚Äî telling Git what to ignore!

At first glance this might seem like an odd thing to want to do, but actually, it proves to be very important in all sorts of ways. Some OSes like to litter directories with special files that contain different information on different computers, many build tools generate vast amounts of temporary files, and many editors create temp files, and many IDEs create config files that you may not want to sync between computers or team members.

## Matching Podcast Episode

TO DO

## Play Along

TO DO

## What does it Mean for Git to Ignore a File?

In your working tree, Git assigns every file one of three statuses:

1. **tracked** ‚Äî the file has been staged or committed (i.e. `git add` was used on it at some time in the past).
2. **untracked** ‚Äî the file is not being tracked, and, Git has not been instructed to ignore it.
3. **ignored** ‚Äî the file matches one of the active *ignore patterns*, **and is not tracked**.

Note that if a file is both tracked and marked to be ignored, being tracked wins ‚Äî in other words, **Git ignores instructions to ignore tracked files**!

What this means that ignoring files from the start is easy, but ignoring previously tracked files later is fiddly at best. In my opinion ignoring tracked files is one of Git's most annoying weaknesses ‚Äî it can be done, but there is no single simple command to do it for you üôÅ

For this reason, **it's considered best practice to make a pro-active decision to track or ignore each new file as it gets added to your repo**.

## How does Git Ignore Files?

Git uses so-called *ignore patterns* to decide whether or not each un-tracked file should be ignored. These patterns very similar to wild-card file paths in Dos or a Linux/Unix shell, but Git does have its own specific syntax.

Just like Git settings, Git ignore patterns can be defined at three levels ‚Äî OS-wide (*system*), for the current user (*global*), and for the current repository (*local*).

Local ignore patterns are defined in a file named `.gitignore` at the repository's root, global ignore patterns are defined in a file specified with the `core.excludesfile` global setting, and OS-wide ignore patterns in a file specified with the `core.excludesfile` system setting. In this instalment we're going to keep things nice and simple and only look at local and global ignore patterns.

## Git Ignore Patterns

Regardless of the level at which you're defining ignore patters, the syntax is the same. The patterns will be added to a file, one pattern per line, and blank lines and lines starting with a `#` symbol will be ignored.

Git ignore patterns don't treat file paths as just strings ‚Äî **Git understands the difference between file names and a file paths, and treats them very differently**. If you forget this subtle but important detail you'll be in for no end of confusion and frustration!

Git will ignore each pattern as a filename, an entire folder, or a path. If a pattern is a filename then it applies in all folders and sub-folders, if it's a folder it applies to the entire contents of the folder, and if it's a path it only applies if the pattern matches the full path. How does Git decide whether a pattern is a file, a folder, or a path? Simple ‚Äî **if a pattern doesn't contain a path separator it's a file, if it ends with a trailing path separator it's a folder, it's a path**.

**Regardless of your OS, Git ignore patterns use `/` as the path separator**.

### Ignoring File Names

Remember, if an ignore pattern does not contain a path separator, Git will treat it as a filename and match it at every level of your repo.

So, to ignore all files named `.DS_Store`, regardless of which folder they're in, you'd use the pattern `.DS_Store`!

Specific file names have their uses, but usually, you want to specify some kind of pattern. The two most common patterns Git ignore definitions support are `*` for *zero or more of anything but a path separator*, and `?` for *exactly one of anything but a path separator*. The most common thing to want to do is to ignore all files with a given extension, for example, to ignore all `.tmp` files you would use the ignore pattern `*.tmp`.

### Ignoring Folders

The rules for ignoring the entire contents of a folder are basically the same as those for ignoring a file, you just have to end the pattern with a trailing `/`. So, to ignore all files in any folder named `logs` anywhere in the repo simply use the pattern `logs/`. To ignore any folder ending in `log` anywhere in the repo use `*log/`.

### Ignoring File Paths

Remember, if an ignore pattern contains a path separator, Git will math the pattern against the full file path, not just the file name.

Git treats file paths quite similar to file names, but there is one important subtlety to note ‚Äî **since `*` does not match path separators, its range is confined within a single item within a file path**, be that a folder name or a file name. For example`*/*.txt` will match `someFolder/someFile.txt`, but it will not match `someFolder/someSubFolder/someFile.txt`! For this reason, Git has one more wild-card for use within file paths ‚Äî `**`, which means *zero or more folders*. For example, `someFolder/**/*.txt` will match `someFolder/someFile.txt` and `someFolder/someSubFolder/someFile.txt`.

### Making Exceptions

Git makes it possible to write broader rules than you might expect by providing a mechanism or carving out exceptions. One small potential gotcha is that the exception has to come **after** the broader rule it overrides in the file.

Exceptions work the same as regular ignore patterns except you pre-fix them with an exclamation point.

As an example, the following pair of patterns blocks all log files except build.log in the repository's root:

```
*.log
!/build.log
```

## Worked Example 1 ‚Äî Ignoring All `.DS_Store` Files on a Mac

Before starting this worked example, you could try force your Mac to create a few `.DS_Store` files for you inside our example repo by opening the folder in the finder and changing some Finder view options something other than the default. I find that using list view and expanding a few folders does the trick every time.

I triggered the Finder to create two `.DS_Store` files for me in the `pbs120a` repo:

```
bart-imac2018:pbs120a bart% git status
On branch main
Your branch is up to date with 'origin/main'.

Untracked files:
  (use "git add <file>..." to include in what will be committed)

	.DS_Store
	contrib/.DS_Store

nothing added to commit but untracked files present (use "git add" to track)
bart-imac2018:pbs120a bart%
```

As mentioned above, to ignore files in all repositories you need to create an ignore file somewhere, then set the global setting `core.excludesfile` to point to that file.

You could create this global ignore file anywhere and call it anything, but the convention is to use `~/.gitignore_global` (`~` being *your home directory* in [POSIX](https://en.wikipedia.org/wiki/POSIX)-compliant operating systems like Unix, Linux & macOS).

We want to ignore all files named `.DS_Store` in all folders, so the pattern we need is simply `.DS_Store`.

Note that if you've already been using Git, it's possible you already have a global git ignore file, so, to be safe, the example command uses the POSIX *append* operator `>>` rather than the *replace* operator `>`. What we want to do is write our pattern into `~/.gitignore_global`. You could use your favourite plain text editor, or, you can use the following terminal command:

```
echo '.DS_Store' >> ~/.gitignore_global
```

The `echo` command simply writes what ever was passed to it to *standard out* (`STDOUT`), and the `>>` operator appends `STDOUT` to the end of the given file.

You can view the contents of your `~/.gitignore_global` file with the command:

```
cat ~/.gitignore_global
```

The file now exists and contains our desired pattern, so, we're now ready to configure Git to use it:

```
git config --global core.excludesfile ~/.gitignore_global
```

With that done, `.DS_Store` files are now hidden from our view in all repos:

```
bart-imac2018:pbs120a bart% git status    
On branch main
Your branch is up to date with 'origin/main'.

nothing to commit, working tree clean
bart-imac2018:pbs120a bart% 
```

## Listing Ignored Files

How do we know the files are really there but being ignored? We can pass the `--ignored` file to `git status` and it will add a section to list all ignored files to the end of the output:

```
bart-imac2018:pbs120a bart% git status --ignored
On branch main
Your branch is up to date with 'origin/main'.

Ignored files:
  (use "git add -f <file>..." to include in what will be committed)

	.DS_Store
	contrib/.DS_Store

nothing to commit, working tree clean
bart-imac2018:pbs120a bart%
```

## Worked Example 2 ‚Äî Ignoring Untracked Files

TO DO

## Worked Example 3 ‚Äî Ignoring Tracked Files

TO DO

## Final Thoughts

TO DO